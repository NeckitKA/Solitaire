//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit1.h"
#include "Unit2.h"
#include "Unit3.h"
#include "Unit4.h"
#include "Unit5.h"
#include "Unit6.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;
//---------------------------------------------------------------------------

__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------

void __fastcall TForm1::N9Click(TObject *Sender)
{
	PlayOrStop(gameOpen,false);
	Form2->ShowModal();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::N10Click(TObject *Sender)
{
	PlayOrStop(gameOpen,false);
	Form3->ShowModal();
    ProcessModalFormResult(Form3->ModalResult);
}
//---------------------------------------------------------------------------

void __fastcall TForm1::N11Click(TObject *Sender)
{
	LogoutAccount();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::N13Click(TObject *Sender)
{
	PlayOrStop(gameOpen,false);
	Form4->ShowModal();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::N14Click(TObject *Sender)
{
	PlayOrStop(gameOpen,false);
	Form5->ShowModal();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::N15Click(TObject *Sender)
{
	PlayOrStop(gameOpen,false);
	Form6->ShowModal();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Image1Click(TObject *Sender)
{
	PlayOrStop(gameOpen,false);
	Form2->ShowModal();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Image2Click(TObject *Sender)
{
	PlayOrStop(gameOpen,false);
	RegisterOrOpenStatistics(N10->Enabled, Form3, Form4);
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Image3Click(TObject *Sender)
{
	PlayOrStop(gameOpen,true);
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Image1MouseEnter(TObject *Sender)
{
	Image1->Picture->LoadFromFile("resources/images/gearstroke60x60.png");
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Image2MouseEnter(TObject *Sender)
{
	Image2->Picture->LoadFromFile("resources/images/greennerdstroke60x60.png");
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Image3MouseEnter(TObject *Sender)
{
	if (pause) {
		Image3->Picture->LoadFromFile("resources/images/playstroke60x60.png");
	}
	else {
		Image3->Picture->LoadFromFile("resources/images/pausestroke60x60.png");
	}

}
//---------------------------------------------------------------------------

void __fastcall TForm1::Image1MouseLeave(TObject *Sender)
{
	Image1->Picture->LoadFromFile("resources/images/gear60x60.png");
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Image2MouseLeave(TObject *Sender)
{
	Image2->Picture->LoadFromFile("resources/images/greennerd60x60.png");
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Image3MouseLeave(TObject *Sender)
{
	if (pause) {
		Image3->Picture->LoadFromFile("resources/images/play60x60.png");
	}
	else {
		Image3->Picture->LoadFromFile("resources/images/pause60x60.png");
	}
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button1Click(TObject *Sender)
{
	Play();
	AddStacksAndCards();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Button2Click(TObject *Sender)
{
	Close();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::Timer1Timer(TObject *Sender)
{
	seconds+=0.1;
	Label1->Caption=AnsiString().sprintf("%.1f", seconds);
}
//---------------------------------------------------------------------------

void __fastcall TForm1::FormClose(TObject *Sender, TCloseAction &Action)
{

	if (gameOpen) {
		DeleteStacksAndCards();
	}
}
//---------------------------------------------------------------------------

void __fastcall TForm1::N4Click(TObject *Sender)
{
    if (gameOpen) {
		DeleteStacksAndCards();
	}
    Play();
	AddStacksAndCards();
}
//---------------------------------------------------------------------------

// my

void TForm1::ProcessModalFormResult(TModalResult result){
		if (result==mrYes) {
		N10->Enabled=false;
		N11->Enabled=true;
		N13->Enabled=true;
		}
}
//---------------------------------------------------------------------------

void TForm1::LogoutAccount(){
	N10->Enabled=true;
	N11->Enabled=false;
	N13->Enabled=false;
}
//---------------------------------------------------------------------------

void TForm1::RegisterOrOpenStatistics (bool N10Enabled,  TForm* Form3, TForm* Form4){
	if (N10Enabled) {
		Form3->ShowModal();
		ProcessModalFormResult(Form3->ModalResult);
	}
	else {
		Form4->ShowModal();
	}
}
//---------------------------------------------------------------------------

void TForm1::Play(){
	Timer1->Enabled=true;
	Button1->Visible=false;
	Button2->Visible=false;
	Image3->Visible=true;
	Label1->Visible=true;
	gameOpen = true;
}
//---------------------------------------------------------------------------

void TForm1::PlayOrStop(bool gameOpen, bool I3){
		if (gameOpen) {
			if (pause && I3) {
				Image3->Picture->LoadFromFile("resources/images/pausestroke60x60.png");
				Timer1->Enabled=true;
				pause = false;
			}
			else if (!pause){
				Image3->Picture->LoadFromFile("resources/images/playstroke60x60.png");
				Timer1->Enabled=false;
				pause = true;

			}
		}
}
//---------------------------------------------------------------------------


void __fastcall TForm1::FormMouseUp(TObject *Sender, TMouseButton Button, TShiftState Shift,
		  int X, int Y)
{
	if (Button == mbRight) {
		bool n—MFW = false; //no—ardsMoveFromWaste
		bool n—MFT0 = false; //no—ardsMoveFromTableau0
		bool n—MFT1 = false;
		bool n—MFT2 = false;
		bool n—MFT3 = false;
		bool n—MFT4 = false;
		bool n—MFT5 = false;
		bool n—MFT6 = false;
		while (!n—MFW && !n—MFT0 && !n—MFT1 && !n—MFT2 && !n—MFT3 && !n—MFT4 && !n—MFT5 && !n—MFT6) {

			if (!waste->cards.empty()) {
				while (!waste->cards.empty() && !n—MFW) {
					if ((!foundationStacks[0]->cards.empty() && (waste->cards.back()->GetValue()-4)==foundationStacks[0]->cards.back()->GetValue()) || ((waste->cards.back()->GetValue())<5 && foundationStacks[0]->cards.size()==0)) {
						waste->cards.back()->SetParentStack(foundationStacks[0]);
						foundationStacks[0]->AddCard(waste->cards.back());
						waste->cards.back()->BringToFront();
						waste->RemoveCard(waste->cards.size()-1);
					}

					else if ((!foundationStacks[1]->cards.empty() && (waste->cards.back()->GetValue()-4)==foundationStacks[1]->cards.back()->GetValue()) || ((waste->cards.back()->GetValue())<5 && foundationStacks[1]->cards.size()==0)) {
						waste->cards.back()->SetParentStack(foundationStacks[1]);
						foundationStacks[1]->AddCard(waste->cards.back());
						waste->cards.back()->BringToFront();
						waste->RemoveCard(waste->cards.size()-1);
					}

					else if ((!foundationStacks[2]->cards.empty() && (waste->cards.back()->GetValue()-4)==foundationStacks[2]->cards.back()->GetValue()) || ((waste->cards.back()->GetValue())<5 && foundationStacks[2]->cards.size()==0)) {
						waste->cards.back()->SetParentStack(foundationStacks[2]);
						foundationStacks[2]->AddCard(waste->cards.back());
						waste->cards.back()->BringToFront();
						waste->RemoveCard(waste->cards.size()-1);
					}

					else if ((!foundationStacks[3]->cards.empty() && (waste->cards.back()->GetValue()-4)==foundationStacks[3]->cards.back()->GetValue()) || ((waste->cards.back()->GetValue())<5 && foundationStacks[3]->cards.size()==0)) {
						waste->cards.back()->SetParentStack(foundationStacks[3]);
						foundationStacks[3]->AddCard(waste->cards.back());
						waste->cards.back()->BringToFront();
						waste->RemoveCard(waste->cards.size()-1);
					}
					else {
						n—MFW = true;
					}
				}
			}
			else {
				n—MFW = true;
            }

			Tableau* tableau0 = dynamic_cast<Tableau*>(tableauStacks[0]);
			Tableau* tableau1 = dynamic_cast<Tableau*>(tableauStacks[1]);
			Tableau* tableau2 = dynamic_cast<Tableau*>(tableauStacks[2]);
			Tableau* tableau3 = dynamic_cast<Tableau*>(tableauStacks[3]);
			Tableau* tableau4 = dynamic_cast<Tableau*>(tableauStacks[4]);
			Tableau* tableau5 = dynamic_cast<Tableau*>(tableauStacks[5]);
			Tableau* tableau6 = dynamic_cast<Tableau*>(tableauStacks[6]);

			if (!tableau0->cards.empty()) {
				while (!tableau0->cards.empty() && !n—MFT0) {
					if ((!foundationStacks[0]->cards.empty() && (tableau0->cards.back()->GetValue()-4)==foundationStacks[0]->cards.back()->GetValue()) || ((tableau0->cards.back()->GetValue())<5 && foundationStacks[0]->cards.size()==0)) {
						tableau0->cards.back()->SetParentStack(foundationStacks[0]);
						foundationStacks[0]->AddCard(tableau0->cards.back());
						tableau0->cards.back()->BringToFront();
						tableau0->RemoveCard();
					}

					else if ((!foundationStacks[1]->cards.empty() && (tableau0->cards.back()->GetValue()-4)==foundationStacks[1]->cards.back()->GetValue()) || ((tableau0->cards.back()->GetValue())<5 && foundationStacks[1]->cards.size()==0)) {
						tableau0->cards.back()->SetParentStack(foundationStacks[1]);
						foundationStacks[1]->AddCard(tableau0->cards.back());
						tableau0->cards.back()->BringToFront();
						tableau0->cards.back()->SetCardOpen(true);
						tableau0->cards.back()->SetCardPicture(tableau0->cards.back()->GetValue(),tableau0->cards.back()->GetCardOpen());
						tableau0->RemoveCard();
					}

					else if ((!foundationStacks[2]->cards.empty() && (tableau0->cards.back()->GetValue()-4)==foundationStacks[2]->cards.back()->GetValue()) || ((tableau0->cards.back()->GetValue())<5 && foundationStacks[2]->cards.size()==0)) {
						tableau0->cards.back()->SetParentStack(foundationStacks[2]);
						foundationStacks[2]->AddCard(tableau0->cards.back());
						tableau0->cards.back()->BringToFront();
						tableau0->cards.back()->SetCardOpen(true);
						tableau0->cards.back()->SetCardPicture(tableau0->cards.back()->GetValue(),tableau0->cards.back()->GetCardOpen());
						tableau0->RemoveCard();
					}

					else if ((!foundationStacks[3]->cards.empty() && (tableau0->cards.back()->GetValue()-4)==foundationStacks[3]->cards.back()->GetValue()) || ((tableau0->cards.back()->GetValue())<5 && foundationStacks[3]->cards.size()==0)) {
						tableau0->cards.back()->SetParentStack(foundationStacks[3]);
						foundationStacks[3]->AddCard(tableau0->cards.back());
						tableau0->cards.back()->BringToFront();
						tableau0->cards.back()->SetCardOpen(true);
						tableau0->cards.back()->SetCardPicture(tableau0->cards.back()->GetValue(),tableau0->cards.back()->GetCardOpen());
						tableau0->RemoveCard();
					}
					else {
						n—MFT0 = true;
					}
				}
			}
			else {
				n—MFT0 = true;
			}

			if (!tableau1->cards.empty()) {
				while (!tableau1->cards.empty() && !n—MFT1) {
					if ((!foundationStacks[0]->cards.empty() && (tableau1->cards.back()->GetValue()-4)==foundationStacks[0]->cards.back()->GetValue()) || ((tableau1->cards.back()->GetValue())<5 && foundationStacks[0]->cards.size()==0)) {
						tableau1->cards.back()->SetParentStack(foundationStacks[0]);
						foundationStacks[0]->AddCard(tableau1->cards.back());
						tableau1->cards.back()->BringToFront();
						tableau1->cards.back()->SetCardOpen(true);
						tableau1->cards.back()->SetCardPicture(tableau1->cards.back()->GetValue(),tableau1->cards.back()->GetCardOpen());
						tableau1->RemoveCard();
					}

					else if ((!foundationStacks[1]->cards.empty() && (tableau1->cards.back()->GetValue()-4)==foundationStacks[1]->cards.back()->GetValue()) || ((tableau1->cards.back()->GetValue())<5 && foundationStacks[1]->cards.size()==0)) {
						tableau1->cards.back()->SetParentStack(foundationStacks[1]);
						foundationStacks[1]->AddCard(tableau1->cards.back());
						tableau1->cards.back()->BringToFront();
						tableau1->cards.back()->SetCardOpen(true);
						tableau1->cards.back()->SetCardPicture(tableau1->cards.back()->GetValue(),tableau1->cards.back()->GetCardOpen());
						tableau1->RemoveCard();
					}

					else if ((!foundationStacks[2]->cards.empty() && (tableau1->cards.back()->GetValue()-4)==foundationStacks[2]->cards.back()->GetValue()) || ((tableau1->cards.back()->GetValue())<5 && foundationStacks[2]->cards.size()==0)) {
						tableau1->cards.back()->SetParentStack(foundationStacks[2]);
						foundationStacks[2]->AddCard(tableau1->cards.back());
						tableau1->cards.back()->BringToFront();
						tableau1->cards.back()->SetCardOpen(true);
						tableau1->cards.back()->SetCardPicture(tableau1->cards.back()->GetValue(),tableau1->cards.back()->GetCardOpen());
						tableau1->RemoveCard();
					}

					else if ((!foundationStacks[3]->cards.empty() && (tableau1->cards.back()->GetValue()-4)==foundationStacks[3]->cards.back()->GetValue()) || ((tableau1->cards.back()->GetValue())<5 && foundationStacks[3]->cards.size()==0)) {
						tableau1->cards.back()->SetParentStack(foundationStacks[3]);
						foundationStacks[3]->AddCard(tableau1->cards.back());
						tableau1->cards.back()->BringToFront();
						tableau1->cards.back()->SetCardOpen(true);
						tableau1->cards.back()->SetCardPicture(tableau1->cards.back()->GetValue(),tableau1->cards.back()->GetCardOpen());
						tableau1->RemoveCard();
					}
					else {
						n—MFT1 = true;
					}
				}
			}
            else {
				n—MFT1 = true;
			}

			if (!tableau2->cards.empty()) {
				while (!tableau2->cards.empty() && !n—MFT2) {
					if ((!foundationStacks[0]->cards.empty() && (tableau2->cards.back()->GetValue()-4)==foundationStacks[0]->cards.back()->GetValue()) || ((tableau2->cards.back()->GetValue())<5 && foundationStacks[0]->cards.size()==0)) {
						tableau2->cards.back()->SetParentStack(foundationStacks[0]);
						foundationStacks[0]->AddCard(tableau2->cards.back());
						tableau2->cards.back()->BringToFront();
						tableau2->cards.back()->SetCardOpen(true);
						tableau2->cards.back()->SetCardPicture(tableau2->cards.back()->GetValue(),tableau2->cards.back()->GetCardOpen());
						tableau2->RemoveCard();
					}

					else if ((!foundationStacks[1]->cards.empty() && (tableau2->cards.back()->GetValue()-4)==foundationStacks[1]->cards.back()->GetValue()) || ((tableau2->cards.back()->GetValue())<5 && foundationStacks[1]->cards.size()==0)) {
						tableau2->cards.back()->SetParentStack(foundationStacks[1]);
						foundationStacks[1]->AddCard(tableau2->cards.back());
						tableau2->cards.back()->BringToFront();
						tableau2->cards.back()->SetCardOpen(true);
						tableau2->cards.back()->SetCardPicture(tableau2->cards.back()->GetValue(),tableau2->cards.back()->GetCardOpen());
						tableau2->RemoveCard();
					}

					else if ((!foundationStacks[2]->cards.empty() && (tableau2->cards.back()->GetValue()-4)==foundationStacks[2]->cards.back()->GetValue()) || ((tableau2->cards.back()->GetValue())<5 && foundationStacks[2]->cards.size()==0)) {
						tableau2->cards.back()->SetParentStack(foundationStacks[2]);
						foundationStacks[2]->AddCard(tableau2->cards.back());
						tableau2->cards.back()->BringToFront();
						tableau2->cards.back()->SetCardOpen(true);
						tableau2->cards.back()->SetCardPicture(tableau2->cards.back()->GetValue(),tableau2->cards.back()->GetCardOpen());
						tableau2->RemoveCard();
					}

					else if ((!foundationStacks[3]->cards.empty() && (tableau2->cards.back()->GetValue()-4)==foundationStacks[3]->cards.back()->GetValue()) || ((tableau2->cards.back()->GetValue())<5 && foundationStacks[3]->cards.size()==0)) {
						tableau2->cards.back()->SetParentStack(foundationStacks[3]);
						foundationStacks[3]->AddCard(tableau2->cards.back());
						tableau2->cards.back()->BringToFront();
						tableau2->cards.back()->SetCardOpen(true);
						tableau2->cards.back()->SetCardPicture(tableau2->cards.back()->GetValue(),tableau2->cards.back()->GetCardOpen());
						tableau2->RemoveCard();
					}
					else {
						n—MFT2 = true;
					}
				}
			}
            else {
				n—MFT2 = true;
			}

			if (!tableau3->cards.empty()) {
				while (!tableau3->cards.empty() && !n—MFT3) {
					if ((!foundationStacks[0]->cards.empty() && (tableau3->cards.back()->GetValue()-4)==foundationStacks[0]->cards.back()->GetValue()) || ((tableau3->cards.back()->GetValue())<5 && foundationStacks[0]->cards.size()==0)) {
						tableau3->cards.back()->SetParentStack(foundationStacks[0]);
						foundationStacks[0]->AddCard(tableau3->cards.back());
						tableau3->cards.back()->BringToFront();
						tableau3->cards.back()->SetCardOpen(true);
						tableau3->cards.back()->SetCardPicture(tableau3->cards.back()->GetValue(),tableau3->cards.back()->GetCardOpen());
						tableau3->RemoveCard();
					}

					else if ((!foundationStacks[1]->cards.empty() && (tableau3->cards.back()->GetValue()-4)==foundationStacks[1]->cards.back()->GetValue()) || ((tableau3->cards.back()->GetValue())<5 && foundationStacks[1]->cards.size()==0)) {
						tableau3->cards.back()->SetParentStack(foundationStacks[1]);
						foundationStacks[1]->AddCard(tableau3->cards.back());
						tableau3->cards.back()->BringToFront();
						tableau3->cards.back()->SetCardOpen(true);
						tableau3->cards.back()->SetCardPicture(tableau3->cards.back()->GetValue(),tableau3->cards.back()->GetCardOpen());
						tableau3->RemoveCard();
					}

					else if ((!foundationStacks[2]->cards.empty() && (tableau3->cards.back()->GetValue()-4)==foundationStacks[2]->cards.back()->GetValue()) || ((tableau3->cards.back()->GetValue())<5 && foundationStacks[2]->cards.size()==0)) {
						tableau3->cards.back()->SetParentStack(foundationStacks[2]);
						foundationStacks[2]->AddCard(tableau3->cards.back());
						tableau3->cards.back()->BringToFront();
						tableau3->cards.back()->SetCardOpen(true);
						tableau3->cards.back()->SetCardPicture(tableau3->cards.back()->GetValue(),tableau3->cards.back()->GetCardOpen());
						tableau3->RemoveCard();
					}

					else if ((!foundationStacks[3]->cards.empty() && (tableau3->cards.back()->GetValue()-4)==foundationStacks[3]->cards.back()->GetValue()) || ((tableau3->cards.back()->GetValue())<5 && foundationStacks[3]->cards.size()==0)) {
						tableau3->cards.back()->SetParentStack(foundationStacks[3]);
						foundationStacks[3]->AddCard(tableau3->cards.back());
						tableau3->cards.back()->BringToFront();
						tableau3->cards.back()->SetCardOpen(true);
						tableau3->cards.back()->SetCardPicture(tableau3->cards.back()->GetValue(),tableau3->cards.back()->GetCardOpen());
						tableau3->RemoveCard();
					}
					else {
						n—MFT3 = true;
					}
				}
			}
            else {
				n—MFT3 = true;
			}

			if (!tableau4->cards.empty()) {
				while (!tableau4->cards.empty() && !n—MFT4) {
					if ((!foundationStacks[0]->cards.empty() && (tableau4->cards.back()->GetValue()-4)==foundationStacks[0]->cards.back()->GetValue()) || ((tableau4->cards.back()->GetValue())<5 && foundationStacks[0]->cards.size()==0)) {
						tableau4->cards.back()->SetParentStack(foundationStacks[0]);
						foundationStacks[0]->AddCard(tableau4->cards.back());
						tableau4->cards.back()->BringToFront();
						tableau4->cards.back()->SetCardOpen(true);
						tableau4->cards.back()->SetCardPicture(tableau4->cards.back()->GetValue(),tableau4->cards.back()->GetCardOpen());
						tableau4->RemoveCard();
					}

					else if ((!foundationStacks[1]->cards.empty() && (tableau4->cards.back()->GetValue()-4)==foundationStacks[1]->cards.back()->GetValue()) || ((tableau4->cards.back()->GetValue())<5 && foundationStacks[1]->cards.size()==0)) {
						tableau4->cards.back()->SetParentStack(foundationStacks[1]);
						foundationStacks[1]->AddCard(tableau4->cards.back());
						tableau4->cards.back()->BringToFront();
						tableau4->cards.back()->SetCardOpen(true);
						tableau4->cards.back()->SetCardPicture(tableau4->cards.back()->GetValue(),tableau4->cards.back()->GetCardOpen());
						tableau4->RemoveCard();
					}

					else if ((!foundationStacks[2]->cards.empty() && (tableau4->cards.back()->GetValue()-4)==foundationStacks[2]->cards.back()->GetValue()) || ((tableau4->cards.back()->GetValue())<5 && foundationStacks[2]->cards.size()==0)) {
						tableau4->cards.back()->SetParentStack(foundationStacks[2]);
						foundationStacks[2]->AddCard(tableau4->cards.back());
						tableau4->cards.back()->BringToFront();
						tableau4->cards.back()->SetCardOpen(true);
						tableau4->cards.back()->SetCardPicture(tableau4->cards.back()->GetValue(),tableau4->cards.back()->GetCardOpen());
						tableau4->RemoveCard();
					}

					else if ((!foundationStacks[3]->cards.empty() && (tableau4->cards.back()->GetValue()-4)==foundationStacks[3]->cards.back()->GetValue()) || ((tableau4->cards.back()->GetValue())<5 && foundationStacks[3]->cards.size()==0)) {
						tableau4->cards.back()->SetParentStack(foundationStacks[3]);
						foundationStacks[3]->AddCard(tableau4->cards.back());
						tableau4->cards.back()->BringToFront();
						tableau4->cards.back()->SetCardOpen(true);
						tableau4->cards.back()->SetCardPicture(tableau4->cards.back()->GetValue(),tableau4->cards.back()->GetCardOpen());
						tableau4->RemoveCard();
					}
					else {
						n—MFT4 = true;
					}
				}
			}
            else {
				n—MFT4 = true;
			}
			if (!tableau5->cards.empty()) {
				while (!tableau5->cards.empty() && !n—MFT5) {
					if ((!foundationStacks[0]->cards.empty() && (tableau5->cards.back()->GetValue()-4)==foundationStacks[0]->cards.back()->GetValue()) || ((tableau5->cards.back()->GetValue())<5 && foundationStacks[0]->cards.size()==0)) {
						tableau5->cards.back()->SetParentStack(foundationStacks[0]);
						foundationStacks[0]->AddCard(tableau5->cards.back());
						tableau5->cards.back()->BringToFront();
						tableau5->cards.back()->SetCardOpen(true);
						tableau5->cards.back()->SetCardPicture(tableau5->cards.back()->GetValue(),tableau5->cards.back()->GetCardOpen());
						tableau5->RemoveCard();
					}

					else if ((!foundationStacks[1]->cards.empty() && (tableau5->cards.back()->GetValue()-4)==foundationStacks[1]->cards.back()->GetValue()) || ((tableau5->cards.back()->GetValue())<5 && foundationStacks[1]->cards.size()==0)) {
						tableau5->cards.back()->SetParentStack(foundationStacks[1]);
						foundationStacks[1]->AddCard(tableau5->cards.back());
						tableau5->cards.back()->BringToFront();
						tableau5->cards.back()->SetCardOpen(true);
						tableau5->cards.back()->SetCardPicture(tableau5->cards.back()->GetValue(),tableau5->cards.back()->GetCardOpen());
						tableau5->RemoveCard();
					}

					else if ((!foundationStacks[2]->cards.empty() && (tableau5->cards.back()->GetValue()-4)==foundationStacks[2]->cards.back()->GetValue()) || ((tableau5->cards.back()->GetValue())<5 && foundationStacks[2]->cards.size()==0)) {
						tableau5->cards.back()->SetParentStack(foundationStacks[2]);
						foundationStacks[2]->AddCard(tableau5->cards.back());
						tableau5->cards.back()->BringToFront();
						tableau5->cards.back()->SetCardOpen(true);
						tableau5->cards.back()->SetCardPicture(tableau5->cards.back()->GetValue(),tableau5->cards.back()->GetCardOpen());
						tableau5->RemoveCard();
					}

					else if ((!foundationStacks[3]->cards.empty() && (tableau5->cards.back()->GetValue()-4)==foundationStacks[3]->cards.back()->GetValue()) || ((tableau5->cards.back()->GetValue())<5 && foundationStacks[3]->cards.size()==0)) {
						tableau5->cards.back()->SetParentStack(foundationStacks[3]);
						foundationStacks[3]->AddCard(tableau5->cards.back());
						tableau5->cards.back()->BringToFront();
						tableau5->cards.back()->SetCardOpen(true);
						tableau5->cards.back()->SetCardPicture(tableau5->cards.back()->GetValue(),tableau5->cards.back()->GetCardOpen());
						tableau5->RemoveCard();
					}
					else {
						n—MFT5 = true;
					}
				}
			}
            else {
				n—MFT5 = true;
			}

			if (!tableau6->cards.empty()) {
				while (!tableau6->cards.empty() && !n—MFT6) {
					if ((!foundationStacks[0]->cards.empty() && (tableau6->cards.back()->GetValue()-4)==foundationStacks[0]->cards.back()->GetValue()) || ((tableau6->cards.back()->GetValue())<5 && foundationStacks[0]->cards.size()==0)) {
						tableau6->cards.back()->SetParentStack(foundationStacks[0]);
						foundationStacks[0]->AddCard(tableau6->cards.back());
						tableau6->cards.back()->BringToFront();
						tableau6->cards.back()->SetCardOpen(true);
						tableau6->cards.back()->SetCardPicture(tableau6->cards.back()->GetValue(),tableau6->cards.back()->GetCardOpen());
						tableau6->RemoveCard();
					}

					else if ((!foundationStacks[1]->cards.empty() && (tableau6->cards.back()->GetValue()-4)==foundationStacks[1]->cards.back()->GetValue()) || ((tableau6->cards.back()->GetValue())<5 && foundationStacks[1]->cards.size()==0)) {
						tableau6->cards.back()->SetParentStack(foundationStacks[1]);
						foundationStacks[1]->AddCard(tableau6->cards.back());
						tableau6->cards.back()->BringToFront();
						tableau6->cards.back()->SetCardOpen(true);
						tableau6->cards.back()->SetCardPicture(tableau6->cards.back()->GetValue(),tableau6->cards.back()->GetCardOpen());
						tableau6->RemoveCard();
					}

					else if ((!foundationStacks[2]->cards.empty() && (tableau6->cards.back()->GetValue()-4)==foundationStacks[2]->cards.back()->GetValue()) || ((tableau6->cards.back()->GetValue())<5 && foundationStacks[2]->cards.size()==0)) {
						tableau6->cards.back()->SetParentStack(foundationStacks[2]);
						foundationStacks[2]->AddCard(tableau6->cards.back());
						tableau6->cards.back()->BringToFront();
						tableau6->cards.back()->SetCardOpen(true);
						tableau6->cards.back()->SetCardPicture(tableau6->cards.back()->GetValue(),tableau6->cards.back()->GetCardOpen());
						tableau6->RemoveCard();
					}

					else if ((!foundationStacks[3]->cards.empty() && (tableau6->cards.back()->GetValue()-4)==foundationStacks[3]->cards.back()->GetValue()) || ((tableau6->cards.back()->GetValue())<5 && foundationStacks[3]->cards.size()==0)) {
						tableau6->cards.back()->SetParentStack(foundationStacks[3]);
						foundationStacks[3]->AddCard(tableau6->cards.back());
						tableau6->cards.back()->BringToFront();
						tableau6->cards.back()->SetCardOpen(true);
						tableau6->cards.back()->SetCardPicture(tableau6->cards.back()->GetValue(),tableau6->cards.back()->GetCardOpen());
						tableau6->RemoveCard();
					}
					else {
						n—MFT6 = true;
					}
				}
			}
            else {
				n—MFT6 = true;
			}
		}
	}
}
//---------------------------------------------------------------------------

void TForm1::AddStacksAndCards(){
	stock = new Stock(0,130,5,this);
	waste = new Waste(1,281,5,this);
	for (int stackNum = 0; stackNum < 4; ++stackNum) {
		foundationStacks.push_back(new Foundation(stackNum+2,583+151*stackNum,5,this));
	}
	for (int stackNum = 0; stackNum < 7; ++stackNum) {
		tableauStacks.push_back(new Tableau (stackNum+6,130+151*stackNum,160,this));
	}
	std::vector<int> cardValues;
	for (int i = 0; i < 52; ++i) {
		cardValues.push_back(i+1);
	}
	std::random_device rd;
	std::mt19937 g(static_cast<unsigned>(std::chrono::system_clock::now().time_since_epoch().count()));
	std::shuffle(cardValues.begin(), cardValues.end(), g);
	int cardCounter = 0;

	for (int stackNum = 0; stackNum < 7; ++stackNum) {
		for (int numOfCards = 0; numOfCards < stackNum+1; numOfCards++) {
			if (numOfCards != stackNum) {
				tableauStacks[stackNum]->AddCardsAtStart(new Card(cardValues[cardCounter++],
					false,tableauStacks[stackNum],this));
			}
			else{
				tableauStacks[stackNum]->AddCardsAtStart(new Card(cardValues[cardCounter++],
					true,tableauStacks[stackNum],this));
			}
		}
	}

    for (int carNum = cardCounter; carNum < cardValues.size(); ++carNum) {
		stock->AddCard(new Card(cardValues[cardCounter++],
			false,stock,this));
	}
}
//---------------------------------------------------------------------------

void TForm1::DeleteStacksAndCards(){
	delete stock;
	delete waste;
	for (int stackNum = 0; stackNum < 4; ++stackNum) {
		delete foundationStacks[stackNum];
	}
	foundationStacks.clear();

	for (int stackNum = 0; stackNum < 7; ++stackNum) {
		delete tableauStacks[stackNum];
	}
	tableauStacks.clear();
};
//---------------------------------------------------------------------------
